---
import type {
    ApartmentCardFragment,
    DisplaySettingsFragment,
} from '../../../../__generated/sdk';
import type { ContentPayload } from '../../../graphql/shared/ContentPayload';
import { isEditContext } from '../../shared/utils.ts';

const isCmsEdit = isEditContext(Astro.url);

export interface Props {
    key: string;
    data: ApartmentCardFragment;
    displaySettings: DisplaySettingsFragment[];
    displayTemplateKey: string;
    contentPayload: ContentPayload;
}

const { key, data, displaySettings, displayTemplateKey, contentPayload } = Astro.props as Props;

const location = [data.City, data.State].filter(Boolean).join(', ');

console.log('Apartment Card', { data: JSON.stringify(data, null, 2), location });
---

<div data-epi-block-id={isCmsEdit && key || undefined} class="component-apartmentcard">
    <div class="card bg-base-200 shadow-md hover:shadow-lg transition-shadow">
        <div class="card-body gap-4">
            <div class="flex items-start justify-between gap-4">
                <div>
                    <h2 class="card-title text-xl">{data.CommunityName}</h2>
                    {location && (
                        <p class="text-sm text-base-content/60 mt-1">{location}</p>
                    )}
                </div>
                {data.Rent != null && (
                    <div class="text-right shrink-0">
                        <p class="text-2xl font-bold text-primary">
                            ${data.Rent.toLocaleString()}
                        </p>
                        <p class="text-xs text-base-content/50">per month</p>
                    </div>
                )}
            </div>
        </div>
    </div>
</div>
